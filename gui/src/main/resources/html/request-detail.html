<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
        <link rel="stylesheet" href="../lib/bootstrap/bootstrap.css"/>
        <link rel="stylesheet" href="../lib/highlight/default.min.css"/>
        <link rel="stylesheet" href="../css/webview/detail-tab.css"/>
        <script src="../lib/popper/popper.min.js"></script>
        <script src="../lib/bootstrap/bootstrap.min.js"></script>
        <script src="../lib/highlight/highlight.min.js"></script>
        <script src="../lib/jq/jquery-3.7.0.min.js"></script>
        <style>

        </style>
    </head>
    <body>
        <div class="container-fluid main">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active fw-bold" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview-tab-pane" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">
                        Overview
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link fw-bold" id="request-tab" data-bs-toggle="tab" data-bs-target="#request-tab-pane" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">
                        &nbsp;Request&nbsp;
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link fw-bold" id="response-tab" data-bs-toggle="tab" data-bs-target="#response-tab-pane" type="button" role="tab" aria-controls="contact-tab-pane" aria-selected="false">
                        Response
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link fw-bold" id="timing-tab" data-bs-toggle="tab" data-bs-target="#timing-tab-pane" type="button" role="tab" aria-controls="disabled-tab-pane" aria-selected="false">
                        &nbsp;Timing&nbsp;
                    </button>
                </li>
            </ul>
            <div class="tab-content" id="myTabContent">
                <!--Overview-->
                <div class="tab-pane fade show active" id="overview-tab-pane" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
                    <div class="container-fluid">
                        <div class="row">
                            <h6 class="title-url">
                                <span class="badge badge-post"></span>
                                <span class="title"></span>
                            </h6>
                            <button class="btn btn-light text-start fw-bold tab-title" type="button" data-bs-toggle="collapse" data-bs-target="#overview" aria-expanded="false" aria-controls="collapseExample">
                                <img class="play-icon spanReset" src="../image/play-solid.svg" alt="">
                                Overview
                            </button>
                            <div class="collapse" id="overview">
                                <div class="card card-body border-light ">
                                    <code class="language-headers">
                                    </code>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="request-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
                    <!--Request-->
                    <div class="container-fluid">
                        <div class="row">
                            <h6 class="title-url">
                                <span class="badge badge-post">POST</span>
                                <span class="title">Http1.1&nbsp;&nbsp;&nbsp;://www.google.com200</span>
                            </h6>
                            <button class="btn btn-light text-start fw-bold tab-title" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                                <img class="play-icon spanReset" src="../image/play-solid.svg" alt="">
                                Headers
                            </button>
                            <div class="collapse" id="requestHeaders">
                                <div class="card card-body border-light ">
                                    <code class="language-headers">
                                    </code>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <button class="btn btn-light text-start fw-bold tab-title" type="button" data-bs-toggle="collapse" data-bs-target="#collapseDetail" aria-expanded="false" aria-controls="collapseExample">
                                <img class="play-icon spanReset" src="../image/play-solid.svg" alt="">
                                Payload
                            </button>
                            <div class="collapse" id="RequestDetail">
                                <div class="card card-body border-light">
                                    <div class="btn-group col-md-6 col-lg-6 col-sm-6" role="group" aria-label="Basic example">
                                        <button type="button" class="btn btn-sm btn-light">Preview</button>
                                        <button type="button" class="btn btn-sm btn-light">Text</button>
                                        <button type="button" class="btn btn-sm btn-light">Origin</button>
                                        <button type="button" class="btn btn-sm btn-light">Hex</button>

                                        <select class="form-select-sm bg-light border-light offset-2" aria-label="select">
                                            <option selected>Code</option>
                                            <option value="1">Json</option>
                                            <option value="2">HTML</option>
                                            <option value="3">XML</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="card card-body border-light ">
                                    <code class="language-json ">
                                    </code>
                                    <img src="../image/file.jpg" class="card-img visually-hidden" alt="Image failed to load">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="response-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
                    <!--Response-->
                    <div class="container-fluid">
                        <div class="row">
                            <h6 class="title-url">
                                <span class="badge badge-post"></span>
                                <span class="title"></span>
                            </h6>
                            <button class="btn btn-light text-start fw-bold tab-title" type="button" data-bs-toggle="collapse" data-bs-target="#responseHeaders" aria-expanded="false" aria-controls="collapseExample">
                                <img class="play-icon spanReset" src="../image/play-solid.svg" alt="">
                                Headers
                            </button>
                            <div class="collapse" id="responseHeaders">
                                <div class="card card-body border-light ">
                                    <code class="language-headers">
                                    </code>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <button class="btn btn-light text-start fw-bold tab-title" type="button" data-bs-toggle="collapse" data-bs-target="#responseDetail" aria-expanded="false" aria-controls="collapseExample">
                                <img class="play-icon spanReset" src="../image/play-solid.svg" alt="">
                                Content
                            </button>
                            <div class="collapse" id="responseDetail">
                                <div class="card card-body border-light">
                                    <div class="btn-group col-md-6 col-lg-6 col-sm-6" role="group" aria-label="Basic example">
                                        <button type="button" class="btn btn-sm btn-light">Preview</button>
                                        <button type="button" class="btn btn-sm btn-light">Text</button>
                                        <button type="button" class="btn btn-sm btn-light">Origin</button>
                                        <button type="button" class="btn btn-sm btn-light">Hex</button>

                                        <select class="form-select-sm bg-light border-light offset-2" aria-label="select">
                                            <option selected>Code</option>
                                            <option value="1">Json</option>
                                            <option value="2">HTML</option>
                                            <option value="3">XML</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="card card-body border-light ">
                                    <code class="language-json">
                                    </code>
                                    <!--<img src="../image/file.jpg" class="card-img visually-hidden" alt="Image failed to load">-->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="timing-tab-pane" role="tabpanel"  tabindex="0">
                    <!--timing-->
                    <div class="container-fluid">
                        <div class="row">
                            <h6 class="title-url">
                                <span class="badge badge-post"></span>
                                <span class="title"></span>
                            </h6>
                            <button class="btn btn-light text-start fw-bold tab-title" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                                <img class="play-icon spanReset" src="../image/play-solid.svg" alt="">
                                Timing
                            </button>
                            <div class="collapse" id="timingDetail">
                                <div class="card card-body border-light ">
                                    <code class="language-headers">
                                    </code>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="../js/detail-tab-main.js"></script>
        <script>
            $(function () {
                bindEvents();

                hljs.configure({
                    tabReplace: '    ', // 4 spaces
                });
                hljs.registerLanguage('headers', function () {
                    return {
                        name: "headers",
                        case_insensitive: true, // language is case-insensitive
                        keywords: '',
                        scope: "test",
                        contains: [
                            {
                                unicodeRegex: '.+?:',
                                scope: 'headers-key',
                                begin: /^.+?:\s/,
                                // end: '\w'
                            }
                        ]
                    }
                });
                initTestData();
                // hljs.highlightAll();
            });

            function bindEvents() {
                $('.btn.tab-title').click(function () {
                    $(this).children('.play-icon').toggleClass('spanRotate');
                })
            }

            function initTestData() {
                renderData("overview", `User-Agent: for "Mozilla: /5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36\nHost: google.com`);
                renderData("responseHeaders", `User-Agent: for "Mozilla: /5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36\nHost: google.com`);
                renderData("responseDetail", `{"name": "Jack"}`);

                let requestInfo = {
                    method: 'PUT',
                    url: 'https://bing.com',
                    protocol: 'HTTP1.1',
                    code: 404
                };
                setUrlTitle(requestInfo);
            }

            // set and render the data of <code>
            function renderData(tabId, content) {
                let selector = `#${tabId} .card code`;
                $(selector).text(content);
                hljs.highlightElement($(selector)[0]);
                new bootstrap.Collapse(`#${tabId}`);
                $(`#${tabId}`).siblings(".tab-title").children('.play-icon').toggleClass('spanRotate');
            }

            // set url, method & protocol info
            function setUrlTitle(requestInfo) {
                let title = `${requestInfo.protocol} ${requestInfo.url} ${requestInfo.code}`;
                $('.title-url .title').text(title);

                let badgeEle = $('.title-url .badge');
                badgeEle.text(requestInfo.method);
                badgeEle.removeClass(function(index, className) {
                    return (className.match(/\bbadge-\S+/g) || []).join(' ');
                });
                badgeEle.addClass('badge-' + requestInfo.method.toLowerCase());
            }
        </script>
    </body>
</html>